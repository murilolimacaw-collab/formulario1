<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>CAW Telecom | Cadastro Técnico do Site</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, sans-serif;
        }

        body {
            margin: 0;
            min-height: 100vh;
            background: radial-gradient(circle at top, #1e2d45, #0b1628 70%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
        }

        .container {
            width: 100%;
            max-width: 1100px;
            background: rgba(15, 25, 45, 0.85);
            border-radius: 16px;
            padding: 40px 50px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        /* HEADER */
        .header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 35px;
        }

        .logo {
            background: #ff9f1c;
            color: #000;
            font-weight: bold;
            padding: 10px 14px;
            border-radius: 10px;
        }

        .header h1 {
            font-size: 20px;
            margin: 0;
        }

        .header span {
            font-size: 13px;
            opacity: 0.8;
        }

        /* SECTIONS */
        .section {
            margin-bottom: 35px;
        }

        .section h2 {
            font-size: 16px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 8px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 6px;
            display: block;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 14px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.15);
            background: rgba(255,255,255,0.08);
            color: #fff;
            outline: none;
        }

        input::placeholder,
        textarea::placeholder {
            color: rgba(255,255,255,0.4);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* FOOTER */
        .footer {
            display: flex;
            justify-content: flex-end;
            margin-top: 30px;
        }

        .btn {
            background: linear-gradient(135deg, #ff9f1c, #ff7b00);
            border: none;
            color: #000;
            font-weight: bold;
            padding: 14px 40px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 15px;
        }

        .btn:hover {
            opacity: 0.9;
        }

        @media (max-width: 900px) {
            .grid, .grid-3 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

<div class="container">

    <!-- HEADER -->
    <div class="header">
        <div class="logo">CAW</div>
        <div>
            <h1>Telecom e Energia</h1>
            <span>Cadastro técnico do site</span>
        </div>
    </div>
     <div class="container">
    <h1>ETAPA 4</h1>
    <h2>IMPOSTOS</h2>

  <form>

    <div class="grid-3">

      <div>
        <label>Estado (UF)</label>
        <input type="text" id="estado" disabled>
      </div>

      <div>
        <label>ICMS (%)</label>
        <input type="text" id="icms" disabled>
      </div>

      <div>
        <label>DIFAL (%)</label>
        <input type="text" id="difal" disabled>
      </div>

      <div>
        <label>PIS (%)</label>
        <input type="text" id="pis" disabled>
      </div>

      <div>
        <label>COFINS (%)</label>
        <input type="text" id="cofins" disabled>
      </div>

      <div>
        <label>ISS (%)</label>
        <input type="text" id="iss" disabled>
      </div>

      <div>
        <label>% Material</label>
        <input type="text" id="material" disabled>
      </div>

      <div>
        <label>% Serviço</label>
        <input type="text" id="servico" disabled>
      </div>

    </div>

    <div class="buttons">
      <a href="etapa3.html" class="btn">⬅ Voltar</a>
     <button type="button" class="btn primary" onclick="salvarEtapa4(); finalizar()">
  Finalizar Cadastro
</button>
<div id="mensagem" class="mensagem"></div>

    </div>

  </form>
</div>

<script>

/* ===============================
   TABELA DE IMPOSTOS POR ESTADO
================================ */

const impostosPorEstado = {
AC:{icms:7,difal:12,pis:1.65,cofins:7.6,iss:5,material:19,servico:81},
AL:{icms:7,difal:12,pis:1.65,cofins:7.6,iss:5,material:19,servico:81},
AP:{icms:6,difal:12,pis:1.65,cofins:7.6,iss:5,material:18,servico:82},
AM:{icms:8,difal:12,pis:1.65,cofins:7.6,iss:5,material:20,servico:80},
BA:{icms:8.5,difal:12,pis:1.65,cofins:7.6,iss:5,material:20.5,servico:79.5},
CE:{icms:8,difal:12,pis:1.65,cofins:7.6,iss:5,material:20,servico:80},
DF:{icms:6,difal:12,pis:1.65,cofins:7.6,iss:5,material:18,servico:82},
ES:{icms:5,difal:12,pis:1.65,cofins:7.6,iss:5,material:17,servico:83},
GO:{icms:7,difal:12,pis:1.65,cofins:7.6,iss:5,material:19,servico:81},
MA:{icms:10,difal:12,pis:1.65,cofins:7.6,iss:5,material:22,servico:78},
MT:{icms:5,difal:12,pis:1.65,cofins:7.6,iss:5,material:17,servico:83},
MS:{icms:5,difal:12,pis:1.65,cofins:7.6,iss:5,material:17,servico:83},
MG:{icms:6,difal:12,pis:1.65,cofins:7.6,iss:5,material:18,servico:82},
PA:{icms:7,difal:12,pis:1.65,cofins:7.6,iss:5,material:19,servico:81},
PB:{icms:8,difal:12,pis:1.65,cofins:7.6,iss:5,material:20,servico:80},
PR:{icms:7,difal:12,pis:1.65,cofins:7.6,iss:5,material:19,servico:81},
PE:{icms:8.5,difal:12,pis:1.65,cofins:7.6,iss:5,material:20.5,servico:79.5},
PI:{icms:9,difal:12,pis:1.65,cofins:7.6,iss:5,material:21,servico:79},
RJ:{icms:8,difal:12,pis:1.65,cofins:7.6,iss:5,material:20,servico:80},
RN:{icms:8,difal:12,pis:1.65,cofins:7.6,iss:5,material:20,servico:80},
RS:{icms:5,difal:12,pis:1.65,cofins:7.6,iss:5,material:17,servico:83},
RO:{icms:5.5,difal:12,pis:1.65,cofins:7.6,iss:5,material:17.5,servico:82.5},
RR:{icms:5,difal:12,pis:1.65,cofins:7.6,iss:5,material:17,servico:83},
SC:{icms:5,difal:12,pis:1.65,cofins:7.6,iss:5,material:17,servico:83},
SP:{icms:6,difal:12,pis:1.65,cofins:7.6,iss:5,material:18,servico:82},
SE:{icms:7,difal:12,pis:1.65,cofins:7.6,iss:5,material:19,servico:81},
TO:{icms:6,difal:12,pis:1.65,cofins:7.6,iss:5,material:18,servico:82}
};

/* ===============================
   PREENCHIMENTO AUTOMÁTICO
================================ */

document.addEventListener("DOMContentLoaded", function(){

    const etapa1 = JSON.parse(localStorage.getItem("etapa1") || "{}");
    const uf = etapa1.estado;

    if(uf && impostosPorEstado[uf]){

        const dados = impostosPorEstado[uf];

        document.getElementById("icms").value = dados.icms;
        document.getElementById("difal").value = dados.difal;
        document.getElementById("pis").value = dados.pis;
        document.getElementById("cofins").value = dados.cofins;
        document.getElementById("iss").value = dados.iss;
        document.getElementById("percent_material").value = dados.material;
        document.getElementById("percent_servico").value = dados.servico;
    }
});


/* ===============================
   SALVAR ETAPA 4
================================ */

function salvarEtapa4(){

    const dados = {
        icms: document.getElementById("icms").value,
        difal: document.getElementById("difal").value,
        pis: document.getElementById("pis").value,
        cofins: document.getElementById("cofins").value,
        iss: document.getElementById("iss").value,
        percent_material: document.getElementById("percent_material").value,
        percent_servico: document.getElementById("percent_servico").value
    };

    localStorage.setItem("etapa4", JSON.stringify(dados));
}


/* ===============================
   FINALIZAR E ENVIAR
================================ */

function finalizar(){

    salvarEtapa4();

    const mensagem = document.getElementById("mensagem");
    mensagem.style.display = "block";
    mensagem.style.color = "black";
    mensagem.innerHTML = "Enviando dados...";

    const etapa1 = JSON.parse(localStorage.getItem("etapa1") || "{}");
    const etapa2 = JSON.parse(localStorage.getItem("etapa2") || "{}");
    const etapa3 = JSON.parse(localStorage.getItem("etapa3") || "{}");
    const etapa4 = JSON.parse(localStorage.getItem("etapa4") || "{}");

    const dados = {...etapa1, ...etapa2, ...etapa3, ...etapa4};

    fetch("https://script.google.com/macros/s/AKfycbzt8FCDz4MUtbcA9y3XKbpfE8MfPVgjKywvyscKTqaeMO8NIVYac6tmedqNO5RlClUj/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(dados)
    })
    .then(response => response.text())
    .then(resposta => {

        console.log("Resposta do servidor:", resposta);

        mensagem.style.color = "green";
        mensagem.innerHTML = "✅ Cadastro enviado com sucesso!";

        localStorage.clear();

        setTimeout(()=>{
            window.location.href = "index.html";
        },2000);

    })
    .catch(error=>{

        console.error("Erro:", error);

        mensagem.style.color = "red";
        mensagem.innerHTML = "❌ Erro ao enviar os dados.";

    });
}

</script>



</body>
</html>